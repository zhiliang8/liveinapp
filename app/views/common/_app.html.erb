<div class="app-item" id="app-<%= app.id%>">
  <div class="row-fluid">
    <div class="app-main">
      <div class="row-fluid app-basic">
        <%= link_to(image_tag(app.logo_url(:thumb)), app, :class => "app-logo box")%>
        <div>
          <p class="app-title">
            <%= link_to content_tag(:strong, app.name), app_path(app)%>
          </p>
          <p>
            <a href="<%= app.url %>" target="_blank"><i class='icon-home'></i><%= app.url %></a>
          </p>
          <p>
            <a href="<%= user_path(app.user) %>" target="_blank"><i class='icon-user'></i><%= app.user.name %></a>
          </p>
        </div>
        <% if params[:controller] == 'apps' %>
        <div class="my-state">
          <% if current_user.present? %>
            <% if current_user.using(app).nil? %>
              <p><a href="#" class="btn btn-inverse">用过该应用</a></p>
            <% else %>
              <p><a href="#" class="btn btn-inverse disabled">已经使用</a></p>
            <% end %>
          <% else %>
            <p><a href="#" class="btn btn-inverse">用过该应用</a></p>
          <% end %>
        </div>
        <% end %>
      </div>
      <div class="row-fluid app-desc">
        <%= params[:controller] == 'home' ? truncate(app.desc, :length => 80) : app.desc %>
      </div>
      <% if params[:controller] == 'apps' %>
        <div class="row-fluid app-using ">
          <div class="pull-right">
            <% if @users.blank? %>
              <span class="label label-info">还没有人使用</span>
            <% else %>
              <%= @users.count %>使用：
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
  <div class="row-fluid app-bar">
    <div class="span12">
      <div class="pull-right">
        <a href="<%= node_apps_path(app.node) %>"><i class='icon-comment'></i>评论</a>
        <a href="<%= node_apps_path(app.node) %>"><i class='icon-tag'></i><%= app.node_name %></a>
        <%= timeago(app.created_at)%>
      </div>
    </div>
  </div>
</div>